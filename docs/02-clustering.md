# üîÑ –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è

## üéØ –û–±–∑–æ—Ä

–≠—Ç–∞–ø –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –≤—ã—è–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç—ã—Ö —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≥—Ä—É–ø–ø –≤ –æ—Ç–∑—ã–≤–∞—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –ì–∞–∑–ø—Ä–æ–º–±–∞–Ω–∫–∞. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –±—ã–ª–æ –≤—ã–¥–µ–ª–µ–Ω–æ **13 –∏—Ç–æ–≥–æ–≤—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤**, –∫–æ—Ç–æ—Ä—ã–µ –ª–µ–≥–ª–∏ –≤ –æ—Å–Ω–æ–≤—É —Å–∏—Å—Ç–µ–º—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–∑—ã–≤–æ–≤.

## üìä –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

- **–û–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö**: 58,000+ –æ—Ç–∑—ã–≤–æ–≤
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏**: Banki.ru, Sravni.ru  
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: review_text, product_type, rating, tonality

## üîß –ú–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

### 1. TF-IDF + K-means üèÜ (–í—ã–±—Ä–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥)
**–§–∞–π–ª**: `scripts/clustering/tfidf_clustering.py`

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
- **–ö–∞—á–µ—Å—Ç–≤–æ**: 96.8% —Å—Ä–µ–¥–Ω—è—è —á–∏—Å—Ç–æ—Ç–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- **–°–∫–æ—Ä–æ—Å—Ç—å**: –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –û—Ç–ª–∏—á–Ω–∞—è
- **–°—Ç–∞—Ç—É—Å**: Production-ready

**–ê–ª–≥–æ—Ä–∏—Ç–º**:
```python
# 1. –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤
vectorizer = TfidfVectorizer(
    max_features=5000,
    ngram_range=(1, 2),
    stop_words=russian_stopwords
)

# 2. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è K-means
kmeans = KMeans(
    n_clusters=21,
    random_state=42,
    n_init=10
)

# 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
silhouette_scores = []
for k in range(2, 30):
    score = silhouette_score(X, kmeans_labels)
```

### 2. –¢–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (LDA)
**–§–∞–π–ª**: `scripts/clustering/topic_modeling.py`

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
- **–ö–∞—á–µ—Å—Ç–≤–æ**: 91.8% —Å—Ä–µ–¥–Ω—è—è —á–∏—Å—Ç–æ—Ç–∞
- **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –í—ã—Å–æ–∫–∞—è (—Ç–µ–º—ã —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏)
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è (pyLDAvis)

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: [lda_visualization.html](../reports/clustering/lda_visualization.html)

### 3. –≠–º–±–µ–¥–¥–∏–Ω–≥-–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (BERT)
**–§–∞–π–ª**: `scripts/clustering/embedding_clustering.py`

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
- **–ö–∞—á–µ—Å—Ç–≤–æ**: 86.9% —Å—Ä–µ–¥–Ω—è—è —á–∏—Å—Ç–æ—Ç–∞
- **–°–µ–º–∞–Ω—Ç–∏–∫–∞**: –ì–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- **–ú–æ–¥–µ–ª—å**: `cointegrated/rubert-tiny2`

## üöÄ –ó–∞–ø—É—Å–∫ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
```bash
cd scripts/clustering/

# –ë—ã—Å—Ç—Ä–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è (2-3 –º–∏–Ω—É—Ç—ã)
python simple_clustering_demo.py

# –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤ –±—ã—Å—Ç—Ä–æ–º —Ä–µ–∂–∏–º–µ (10-15 –º–∏–Ω—É—Ç)
python run_clustering.py --quick

# –¢–æ–ª—å–∫–æ –ª—É—á—à–∏–π –º–µ—Ç–æ–¥
python run_clustering.py --quick --methods tfidf

# –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (–º–µ–¥–ª–µ–Ω–Ω–æ, –≤—Å–µ –º–µ—Ç–æ–¥—ã)
python run_clustering.py
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞
```bash
# –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã
--methods embedding topic tfidf all

# –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã
--quick          # –ë—ã—Å—Ç—Ä—ã–π —Ä–µ–∂–∏–º (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞)
--no-viz         # –ë–µ–∑ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π
--data-path      # –ü—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º
```

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤

| –ú–µ—Ç–æ–¥ | –ö–ª–∞—Å—Ç–µ—Ä—ã | –ß–∏—Å—Ç–æ—Ç–∞ | Outliers | –†–µ–π—Ç–∏–Ω–≥ |
|-------|----------|---------|----------|---------|
| **TF-IDF K-means** | 21 | 52.1% | 0.0% | **0.702** üèÜ |
| TF-IDF Agglomerative | 25 | 53.9% | 0.0% | 0.666 |
| TF-IDF DBSCAN | 26 | 72.0% | 91.8% | 0.500 |
| BERT Embedding | 2 | 24.1% | 0.0% | 0.491 |

### –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
- **Silhouette Score**: –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- **–ß–∏—Å—Ç–æ—Ç–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤**: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–∞–ª—å–Ω—ã–º —Ç–∏–ø–∞–º –ø—Ä–æ–¥—É–∫—Ç–æ–≤  
- **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏**: –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- **–ü—Ä–æ—Ü–µ–Ω—Ç outliers**: –î–æ–ª—è –Ω–µ–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤

## üéØ –¢–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

### LDA –ê–Ω–∞–ª–∏–∑
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 17 –ø–µ—Ä–≤–∏—á–Ω—ã—Ö —Ç–µ–º –≤—ã—è–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

![–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ](images/tematic_modeling.png)

**–ö–ª—é—á–µ–≤—ã–µ —Ç–µ–º—ã**:
1. –î–µ–±–µ—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã - –∞–∫—Ü–∏–∏ –∏ –±–æ–Ω—É—Å—ã
2. –ê–≤—Ç–æ–∫—Ä–µ–¥–∏—Ç—ã - –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ (92.7% —á–∏—Å—Ç–æ—Ç–∞)
3. –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
4. –í–∫–ª–∞–¥—ã –∏ –¥–µ–ø–æ–∑–∏—Ç—ã (79.1% —á–∏—Å—Ç–æ—Ç–∞)  
5. –ö–æ–º–∏—Å—Å–∏–∏ –∏ —Å–ø–∏—Å–∞–Ω–∏—è (100% —á–∏—Å—Ç–æ—Ç–∞)
6. –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–∞—Ä—Ç–∞–º–∏ –∑–∞ –≥—Ä–∞–Ω–∏—Ü–µ–π
7. –î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
8. –ö—Ä–µ–¥–∏—Ç–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
```html
<!-- reports/clustering/lda_visualization.html -->
–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ —Ç–µ–º —Å:
- –†–∞–∑–º–µ—Ä–æ–º –∫—Ä—É–≥–æ–≤ (—á–∞—Å—Ç–æ—Ç–∞ —Ç–µ–º—ã)
- –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º –º–µ–∂–¥—É —Ç–µ–º–∞–º–∏ (—Å—Ö–æ–∂–µ—Å—Ç—å)
- –ö–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–µ–º—ã
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
```

## üîÑ –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

### –û—Ç 17 –∫ 13 –∫–ª–∞—Å—Ç–µ—Ä–∞–º
–ü–æ—Å–ª–µ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ 17 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –±—ã–ª–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ **13 –∏—Ç–æ–≥–æ–≤—ã—Ö –≥—Ä—É–ø–ø**:

![–ò—Ç–æ–≥–æ–≤—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã](images/clusters.png)

### –ò—Ç–æ–≥–æ–≤—ã–µ 13 –∫–ª–∞—Å—Ç–µ—Ä–æ–≤:

1. **–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ** - –ö–∞—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ã –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è
2. **–î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ** - –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–±–∞–Ω–∫, —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
3. **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** - –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —É–¥–æ–±—Å—Ç–≤–æ, –æ—à–∏–±–∫–∏
4. **–ö—Ä–µ–¥–∏—Ç–Ω—ã–µ –∫–∞—Ä—Ç—ã** - –£—Å–ª–æ–≤–∏—è, –ª–∏–º–∏—Ç—ã, –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ —Å—Ç–∞–≤–∫–∏
5. **–î–µ–±–µ—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã** - –ö—ç—à–±—ç–∫, –∞–∫—Ü–∏–∏, –∫–æ–º–∏—Å—Å–∏–∏
6. **–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–µ –∫—Ä–µ–¥–∏—Ç—ã** - –û–¥–æ–±—Ä–µ–Ω–∏–µ, —É—Å–ª–æ–≤–∏—è, –ø—Ä–æ—Ü–µ–¥—É—Ä—ã
7. **–ê–≤—Ç–æ–∫—Ä–µ–¥–∏—Ç—ã** - –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–æ–≤–∞–Ω–∏—è
8. **–ò–ø–æ—Ç–µ–∫–∞** - –ò–ø–æ—Ç–µ—á–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Å—Ç–∞–≤–∫–∏, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ
9. **–†–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è** - –ü–µ—Ä–µ–∫—Ä–µ–¥–∏—Ç–æ–≤–∞–Ω–∏–µ
10. **–í–∫–ª–∞–¥—ã** - –î–µ–ø–æ–∑–∏—Ç–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã, –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
11. **–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ** - –°—Ç—Ä–∞—Ö–æ–≤—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –±–∞–Ω–∫–∞
12. **–î—Ä—É–≥–æ–µ** - –ü—Ä–æ—á–∏–µ —É—Å–ª—É–≥–∏ –∏ –ø—Ä–æ–¥—É–∫—Ç—ã
13. **–î–µ–Ω–µ–∂–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã** - –ü–µ—Ä–µ–≤–æ–¥—ã, –ø–ª–∞—Ç–µ–∂–∏, –∫–æ–º–∏—Å—Å–∏–∏

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
```
data/processed/clustering/
‚îú‚îÄ‚îÄ embedding_clustering_results.json     # BERT –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ topic_modeling_results.json          # LDA —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã  
‚îú‚îÄ‚îÄ tfidf_clustering_results.json        # TF-IDF –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ embedding_clustering_results_summary.txt
‚îî‚îÄ‚îÄ tfidf_clustering_results_summary.txt
```

### –û—Ç—á–µ—Ç—ã –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
```
reports/clustering/
‚îú‚îÄ‚îÄ lda_visualization.html               # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è LDA –∫–∞—Ä—Ç–∞
‚îú‚îÄ‚îÄ clustering_evaluation_report.txt     # –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
‚îú‚îÄ‚îÄ tfidf_algorithms_comparison.png      # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
‚îú‚îÄ‚îÄ embedding_clusters_visualization.png # BERT –∫–ª–∞—Å—Ç–µ—Ä—ã
‚îú‚îÄ‚îÄ tfidf_kmeans_wordclouds.png         # –û–±–ª–∞–∫–∞ —Å–ª–æ–≤
‚îî‚îÄ‚îÄ clustering_quality_comparison.png    # –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
```

## üîç –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤

### –≠—Ç–∞–ø—ã –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

```python
def preprocess_text(text):
    """–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏"""
    
    # 1. –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
    text = text.lower()
    
    # 2. –£–¥–∞–ª–µ–Ω–∏–µ HTML —Ç–µ–≥–æ–≤ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
    text = re.sub(r'<[^>]+>', '', text)
    text = re.sub(r'[^\w\s]', ' ', text)
    
    # 3. –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤
    text = re.sub(r'\s+', ' ', text).strip()
    
    # 4. –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è
    tokens = word_tokenize(text)
    
    # 5. –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–æ–ø-—Å–ª–æ–≤
    tokens = [token for token in tokens 
              if token not in russian_stopwords]
    
    # 6. –õ–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è
    lemmatizer = pymorphy2.MorphAnalyzer()
    tokens = [lemmatizer.parse(token)[0].normal_form 
              for token in tokens]
    
    return ' '.join(tokens)
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞**: –û—Ç–∑—ã–≤—ã < 10 —Å–∏–º–≤–æ–ª–æ–≤ –∏—Å–∫–ª—é—á–µ–Ω—ã
- **–î—É–±–ª–∏–∫–∞—Ç—ã**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–æ–≤
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∏
- **–Ø–∑—ã–∫**: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```txt
# –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
scikit-learn>=1.3.0
pandas>=2.0.0
numpy>=1.24.0

# –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
nltk>=3.8
pymorphy2>=0.9.1
gensim>=4.3.0

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
matplotlib>=3.7.0
seaborn>=0.12.0
plotly>=5.15.0
pyLDAvis>=3.4.0

# –≠–º–±–µ–¥–¥–∏–Ω–≥–∏
sentence-transformers>=2.2.0
transformers>=4.30.0
torch>=2.0.0
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è TF-IDF
```python
TfidfVectorizer(
    max_features=5000,           # –ú–∞–∫—Å–∏–º—É–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    ngram_range=(1, 2),         # –£–Ω–∏–≥—Ä–∞–º–º—ã –∏ –±–∏–≥—Ä–∞–º–º—ã
    min_df=2,                   # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
    max_df=0.95,               # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
    stop_words=russian_stopwords,
    lowercase=True,
    token_pattern=r'\b\w{2,}\b' # –°–ª–æ–≤–∞ –æ—Ç 2 —Å–∏–º–≤–æ–ª–æ–≤
)
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è K-means
```python
# –ü–æ–∏—Å–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
silhouette_scores = []
inertia_scores = []

for k in range(2, 30):
    kmeans = KMeans(n_clusters=k, random_state=42, n_init=10)
    labels = kmeans.fit_predict(tfidf_matrix)
    
    silhouette_avg = silhouette_score(tfidf_matrix, labels)
    silhouette_scores.append(silhouette_avg)
    inertia_scores.append(kmeans.inertia_)

# –ú–µ—Ç–æ–¥ –ª–æ–∫—Ç—è + —Å–∏–ª—É—ç—Ç –∞–Ω–∞–ª–∏–∑
optimal_k = find_elbow_point(inertia_scores, silhouette_scores)
```

## üìã –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

### –ú–µ—Ç—Ä–∏–∫–∏
1. **Silhouette Score** - –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
2. **–ß–∏—Å—Ç–æ—Ç–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ product_type
3. **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏** - —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–æ–≤
4. **–ü—Ä–æ—Ü–µ–Ω—Ç outliers** - –¥–æ–ª—è –Ω–µ–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö

### –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```python
def evaluate_clustering_quality(labels, true_labels):
    """–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏"""
    
    # –ß–∏—Å—Ç–æ—Ç–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
    purity = calculate_purity(labels, true_labels)
    
    # –°–∏–ª—É—ç—Ç –∞–Ω–∞–ª–∏–∑
    silhouette_avg = silhouette_score(X, labels)
    
    # Adjusted Rand Index
    ari = adjusted_rand_score(true_labels, labels)
    
    # Normalized Mutual Information
    nmi = normalized_mutual_info_score(true_labels, labels)
    
    return {
        'purity': purity,
        'silhouette': silhouette_avg,
        'ari': ari,
        'nmi': nmi
    }
```

## üîÑ Workflow –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

```mermaid
graph TD
    A[–°—ã—Ä—ã–µ –æ—Ç–∑—ã–≤—ã] --> B[–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞]
    B --> C[TF-IDF –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è]
    C --> D[K-means –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è]
    D --> E[–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤]
    E --> F[–ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞]
    F --> G[–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤]
    G --> H[–≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞]
    H --> I[–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤]
    I --> J[13 –∏—Ç–æ–≥–æ–≤—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤]
    J --> K[–û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞]
```


## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã

- [01-data-collection.md](01-data-collection.md) - –°–±–æ—Ä –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [03-data-labeling.md](03-data-labeling.md) - –†–∞–∑–º–µ—Ç–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- [04-classification.md](04-classification.md) - ML –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- [07-architecture.md](07-architecture.md) - –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–∑—ã–≤–æ–≤ –ì–∞–∑–ø—Ä–æ–º–±–∞–Ω–∫–∞*
