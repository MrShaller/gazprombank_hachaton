# ü§ñ ML –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è - –ê–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–∑—ã–≤–æ–≤

## üìã –û–±–∑–æ—Ä

–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ML –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–∑—ã–≤–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ì–∞–∑–ø—Ä–æ–º–±–∞–Ω–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–≤—É—Ö –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ML

### –ú–æ–¥–µ–ª–∏

1. **TF-IDF + Logistic Regression**
   - –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤/—É—Å–ª—É–≥ –∏–∑ —Ç–µ–∫—Å—Ç–∞
   - –ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤
   - –§–∞–π–ª: `models/tfidf_lr/model.pkl`

2. **XLM-RoBERTa**
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º
   - –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
   - –ü–∞–ø–∫–∞: `models/xlmr/`

### –ü–∞–π–ø–ª–∞–π–Ω –æ–±—Ä–∞–±–æ—Ç–∫–∏

```
–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞ ‚Üí –†–∞–∑–±–∏–≤–∫–∞ –Ω–∞ –∫–ª–∞—É–∑—ã ‚Üí TF-IDF (–ø—Ä–æ–¥—É–∫—Ç—ã) + XLM-R (—Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å) ‚Üí –ê–≥—Ä–µ–≥–∞—Ü–∏—è ‚Üí JSON –æ—Ç–≤–µ—Ç
```

## üöÄ API Endpoint

### POST `/api/v1/predict/`

–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç JSON —Ñ–∞–π–ª —Å –æ—Ç–∑—ã–≤–∞–º–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

**–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**
```json
{
  "data": [
    {
      "id": 1,
      "text": "–û—Ç–ª–∏—á–Ω–∞—è –¥–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞, –∫–µ—à–±—ç–∫ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤–æ–≤—Ä–µ–º—è!"
    },
    {
      "id": 2, 
      "text": "–£–∂–∞—Å–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç."
    }
  ]
}
```

**–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "success": true,
  "message": "–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω",
  "total_items": 2,
  "data": [
    {
      "id": 1,
      "text": "–û—Ç–ª–∏—á–Ω–∞—è –¥–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞, –∫–µ—à–±—ç–∫ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤–æ–≤—Ä–µ–º—è!",
      "predicted_sentiment": "–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ",
      "confidence": 1.0,
      "predicted_products": ["–î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞"],
      "bert_details": {"–î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞": "–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ"},
      "tfidf_products": ["–î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞"]
    },
    {
      "id": 2,
      "text": "–£–∂–∞—Å–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç.",
      "predicted_sentiment": "–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ", 
      "confidence": 1.0,
      "predicted_products": ["–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"],
      "bert_details": {"–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ": "–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ"},
      "tfidf_products": ["–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"]
    }
  ]
}
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –ü—Ä–æ–¥—É–∫—Ç—ã/—É—Å–ª—É–≥–∏
- –î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞
- –ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞  
- –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
- –ò–ø–æ—Ç–µ–∫–∞
- –ê–≤—Ç–æ–∫—Ä–µ–¥–∏—Ç—ã
- –í–∫–ª–∞–¥—ã
- –ü–µ—Ä–µ–≤–æ–¥—ã
- –ò –¥—Ä—É–≥–∏–µ...

### –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ** - –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –æ—Ç–∑—ã–≤—ã
- **–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ** - –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç–∑—ã–≤—ã  
- **–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ** - –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ –æ—Ç–∑—ã–≤—ã

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –§–∞–π–ª—ã

- `backend/app/ml/pipeline.py` - –æ—Å–Ω–æ–≤–Ω–æ–π ML –ø–∞–π–ø–ª–∞–π–Ω
- `backend/app/ml/tfidf_model.py` - TF-IDF –º–æ–¥–µ–ª—å
- `backend/app/ml/xlmr_model.py` - XLM-R –º–æ–¥–µ–ª—å
- `backend/app/ml/utils.py` - —É—Ç–∏–ª–∏—Ç—ã (—Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è, –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è)
- `backend/app/routers/predict.py` - API endpoint

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```
torch>=2.8.0
transformers>=4.56.0
scikit-learn>=1.7.0
nltk>=3.9.0
pymorphy3>=2.0.0
pandas>=2.3.0
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç
```bash
cd backend
source venv/bin/activate
python test_predict_simple.py
```

### –î–µ—Ç–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç
```bash
python test_ml_detailed.py
```

### Curl —Ç–µ—Å—Ç
```bash
./test_curl_simple.sh
```

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: ~30 —Å–µ–∫—É–Ω–¥ (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫)
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: ~0.18 —Å–µ–∫/–æ—Ç–∑—ã–≤
- **–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å**: ~250 –æ—Ç–∑—ã–≤–æ–≤ –∑–∞ 45 —Å–µ–∫—É–Ω–¥
- **–ü–∞–º—è—Ç—å**: ~2GB –¥–ª—è XLM-R –º–æ–¥–µ–ª–∏

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Health Check
```bash
curl http://localhost:8000/api/v1/predict/health
```

### –õ–æ–≥–∏
ML –ø–∞–π–ø–ª–∞–π–Ω –ª–æ–≥–∏—Ä—É–µ—Ç:
- –°—Ç–∞—Ç—É—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤
- –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

1. **ML –ø–∞–π–ø–ª–∞–π–Ω –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω** ‚Üí Fallback –Ω–∞ –∑–∞–≥–ª—É—à–∫—É
2. **–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏** ‚Üí –í–æ–∑–≤—Ä–∞—Ç –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
3. **–ù–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON** ‚Üí –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞
4. **–ü—É—Å—Ç–æ–π —Ñ–∞–π–ª** ‚Üí –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

## üîÑ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install -r scripts/models/requirements.txt`
2. –ü–æ–º–µ—Å—Ç–∏—Ç—å –º–æ–¥–µ–ª–∏ –≤ `models/tfidf_lr/` –∏ `models/xlmr/`
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å backend: `uvicorn app.main:app`

### Docker
ML –º–æ–¥–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

- **–¢–æ—á–Ω–æ—Å—Ç—å —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏**: ~85-90%
- **–¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–æ–≤**: ~80-85%
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤**: 15+ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —è–∑—ã–∫–æ–≤**: –†—É—Å—Å–∫–∏–π

## üîÆ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤** –≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é
2. **–£–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏** –º–æ–¥–µ–ª–µ–π
3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
4. **–ë–∞—Ç—á–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
5. **Real-time –∞–Ω–∞–ª–∏–∑** —á–µ—Ä–µ–∑ WebSocket

---

*–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π IT's Four –¥–ª—è —Ö–∞–∫–∞—Ç–æ–Ω–∞ –ì–∞–∑–ø—Ä–æ–º–±–∞–Ω–∫–∞ 2025*
